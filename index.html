<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA DE CONTROL ESTRATÉGICO OTI - PRONIED</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,400;0,500;0,600;0,700;0,800;1,400&family=Outfit:wght@700;800;900&family=JetBrains+Mono:wght@500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <style>
        /* ==========================================================================
           1. ARQUITECTURA DE DISEÑO - ESTILO INSTITUCIONAL ROBUSTO
           ========================================================================== */
        :root {
            --oti-red-primary: #C51118;
            --oti-red-deep: #A50E13;
            --oti-red-soft: #FFF1F2;
            --oti-navy-base: #0F172A;
            --oti-navy-muted: #1E293B;
            --oti-yellow-accent: #FACC15;
            --oti-white: #FFFFFF;
            --oti-ink-black: #000000;
            
            --border-heavy: 3.5px solid var(--oti-ink-black);
            --border-standard: 2.2px solid var(--oti-ink-black);
            --border-light: 1.2px solid #CBD5E1;

            --sidebar-width: 350px;
            --shadow-neo-heavy: 12px 12px 0px rgba(0,0,0,1);
            --shadow-neo-small: 6px 6px 0px rgba(0,0,0,1);
            
            --transition-main: all 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        }

        /* AJUSTE DE ZOOM SOLICITADO (WEB) */
        html {
            zoom: 0.85; 
            -moz-transform: scale(0.85);
            -moz-transform-origin: 0 0;
        }

        *, *::before, *::after { 
            margin: 0; padding: 0; box-sizing: border-box; 
            -webkit-font-smoothing: antialiased; 
        }
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--oti-white);
            color: var(--oti-navy-base);
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ==========================================================================
           2. SIDEBAR - PANEL DE CONTROL ESTRATÉGICO
           ========================================================================== */
        .sidebar-master {
            width: var(--sidebar-width);
            background: #F8FAFC;
            height: 100vh;
            position: fixed;
            left: 0; top: 0;
            padding: 40px 30px;
            display: flex;
            flex-direction: column;
            border-right: 18px solid var(--oti-red-primary);
            box-shadow: 15px 0 50px rgba(0,0,0,0.1);
            z-index: 1100;
        }

        .header-brand {
            background: white;
            border: var(--border-heavy);
            border-radius: 22px;
            padding: 30px 15px;
            text-align: center;
            margin-bottom: 35px;
            box-shadow: var(--shadow-neo-small);
        }
        .header-brand h2 { 
            color: var(--oti-red-primary); 
            font-family: 'Outfit'; 
            font-size: 40px; 
            font-weight: 900; 
            line-height: 0.85; 
            letter-spacing: -2px;
        }
        .header-brand p { 
            font-size: 10px; 
            font-weight: 800; 
            text-transform: uppercase; 
            margin-top: 15px; 
            color: var(--oti-navy-muted);
            letter-spacing: 0.8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px 25px;
            background: white;
            border: var(--border-standard);
            border-radius: 15px;
            color: black;
            text-decoration: none;
            margin-bottom: 15px;
            font-weight: 800;
            font-size: 13.5px;
            transition: var(--transition-main);
            box-shadow: var(--shadow-neo-small);
        }
        .nav-link i { color: var(--oti-red-primary); font-size: 20px; width: 28px; text-align: center; }
        .nav-link:hover {
            transform: translate(-3px, -3px);
            box-shadow: 8px 8px 0px var(--oti-red-primary);
            background: var(--oti-navy-base);
            color: white;
        }

        .metrics-card {
            background: white;
            border: var(--border-heavy);
            border-radius: 22px;
            padding: 25px 20px;
            margin: 15px 0;
            box-shadow: var(--shadow-neo-small);
        }
        .metrics-card .label {
            display: block; font-size: 12px; font-weight: 900; text-transform: uppercase;
            border-bottom: 4px solid #000; padding-bottom: 10px; margin-bottom: 15px; text-align: center;
        }
        .grid-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .stat-item { padding: 12px 5px; border: 2px solid #000; border-radius: 12px; text-align: center; }
        .stat-item b { font-family: 'Outfit'; font-size: 28px; line-height: 1; }
        .stat-item span { font-size: 8.5px; font-weight: 900; text-transform: uppercase; display: block; }

        .s-ok { background: #DCFCE7; color: #166534; }
        .s-pen { background: #FEE2E2; color: #991B1B; }
        .s-upd { background: #FEF3C7; color: #92400E; }
        .s-na { background: #F1F5F9; color: #475569; }

        .progress-box {
            margin-top: auto;
            background: var(--oti-navy-base);
            border-radius: 25px;
            padding: 25px;
            border: var(--border-standard);
            color: white;
            box-shadow: var(--shadow-neo-small);
        }
        .progress-box b { font-family: 'Outfit'; font-size: 40px; color: var(--oti-yellow-accent); line-height: 0.8; }
        .rail { height: 14px; background: rgba(255,255,255,0.15); border-radius: 10px; border: 2px solid #000; margin: 15px 0; overflow: hidden; }
        .fill { height: 100%; background: linear-gradient(90deg, var(--oti-red-primary), #ff4d4d); width: 0%; transition: 3s ease; }

        /* ==========================================================================
           3. AREA DE TRABAJO - WORKSPACE
           ========================================================================== */
        .workspace { margin-left: var(--sidebar-width); width: calc(100% - var(--sidebar-width)); padding: 60px 80px; }
        
        .workspace h1 { 
            font-family: 'Outfit'; font-size: 62px; font-weight: 900; color: var(--oti-navy-base); 
            text-align: center; margin-bottom: 50px; letter-spacing: -2.5px; line-height: 0.9; text-transform: uppercase;
        }

        .search-area { max-width: 850px; margin: 0 auto 45px auto; position: relative; }
        .search-area input { 
            width: 100%; padding: 25px 40px 25px 85px; border-radius: 100px; border: var(--border-heavy); 
            font-size: 18px; font-weight: 700; box-shadow: 0 15px 35px rgba(0,0,0,0.05); outline: none;
        }
        .search-area i { position: absolute; left: 35px; top: 50%; transform: translateY(-50%); color: var(--oti-red-primary); font-size: 30px; }

        .hub-buttons { display: flex; justify-content: center; gap: 30px; margin-bottom: 60px; }
        .btn-hub { 
            padding: 22px 55px; border-radius: 100px; font-family: 'Outfit'; font-weight: 800; font-size: 16px; 
            text-decoration: none; border: var(--border-heavy); transition: 0.4s; cursor: pointer; display: flex; align-items: center; gap: 15px;
        }
        .btn-main { background: var(--oti-red-primary); color: white; box-shadow: 0 12px 0 #000; }
        .btn-sec { background: white; color: var(--oti-red-primary); box-shadow: 0 12px 0 #000; }
        .btn-hub:hover { transform: translateY(-5px); box-shadow: 0 18px 0 #000; }

        /* ==========================================================================
           4. TABLA - DISEÑO DE MATRIZ FINAL (CENTRADO DE ENCABEZADOS)
           ========================================================================== */
        .matrix-frame { 
            background: white; border: var(--border-heavy); border-radius: 35px; 
            padding: 50px; box-shadow: var(--shadow-neo-heavy);
        }

        .oti-table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        
        /* Column widths */
        .col-id { width: 85px; } 
        .col-status { width: 190px; }
        .col-obs { width: 33%; }

        th { 
            padding: 25px 20px; text-align: center; 
            font-size: 12px; font-weight: 900; 
            color: #000; text-transform: uppercase; border-bottom: var(--border-heavy); 
            background: #F8FAFC; border-right: var(--border-light);
        }
        
        td { padding: 32px 25px; border-bottom: var(--border-standard); border-right: var(--border-light); vertical-align: middle; }
        
        .cell-id { 
            width: 85px !important; text-align: center; font-family: 'JetBrains Mono'; 
            font-weight: 800; color: var(--oti-red-primary); font-size: 28px; 
            background: var(--oti-red-soft) !important; border-right: var(--border-heavy) !important; 
        }

        .cell-content-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .cell-title { 
            font-size: 15.5px; font-weight: 800; color: var(--oti-navy-base); 
            display: block; margin-bottom: 12px; line-height: 1.3;
        }

        .cell-norma { 
            font-size: 10px; color: var(--oti-red-primary); font-weight: 700; background: var(--oti-red-soft); 
            padding: 6px 14px; border-radius: 10px; border: 1.8px solid var(--oti-red-primary); 
            text-decoration: none; display: inline-flex; align-items: center; gap: 6.5px;
            transition: 0.3s ease;
        }
        .cell-norma:hover { background: var(--oti-red-primary); color: white; transform: scale(1.05); }

        .pill-status { 
            display: block; margin: 0 auto; padding: 15px 0; width: 155px; border-radius: 14px; 
            font-size: 10.5px; font-weight: 900; text-transform: uppercase; border: var(--border-standard); 
            box-shadow: 5px 5px 0px #000; text-align: center;
        }

        .obs-content { font-size: 14px; color: #475569; font-weight: 500; line-height: 1.6; text-align: left; }

        /* ==========================================================================
           5. OPTIMIZACIÓN PDF (A4)
           ========================================================================== */
        @media print {
            @page { size: A4 portrait; margin: 12mm 10mm; }
            html { zoom: 1; -moz-transform: none; }
            body { background: white !important; }
            .sidebar-master, .search-area, .hub-buttons { display: none !important; }
            .workspace { margin: 0; padding: 0; width: 100%; }
            .matrix-frame { border: none; padding: 0; }
            .oti-table { border: 3.5pt solid #000; }
            th { border: 2pt solid #000; background: #f0f0f0 !important; font-size: 11pt; text-align: center; }
            .cell-title { font-size: 12pt !important; line-height: 1.2 !important; }
            .cell-id { width: 60pt !important; border-right: 3.5pt solid #000 !important; font-size: 22pt !important; }
            td { border: 1.8pt solid #000 !important; font-size: 10pt !important; padding: 15pt 12pt !important; }
            .pill-status { box-shadow: none; border: 2pt solid #000; width: 120pt; }
        }

        /* ==========================================================================
           6. OPTIMIZACIÓN RESPONSIVE
           ========================================================================== */
        @media screen and (max-width: 1024px) {
            html { zoom: 1; -moz-transform: none; }
            body { flex-direction: column; }
            .sidebar-master { width: 100%; height: auto; position: relative; border-right: none; border-bottom: 12px solid var(--oti-red-primary); padding: 30px 20px; }
            .workspace { margin-left: 0; width: 100%; padding: 40px 20px; }
            .workspace h1 { font-size: 34px; letter-spacing: -1px; }
            .hub-buttons { flex-direction: column; gap: 15px; }
            .btn-hub { width: 100%; justify-content: center; }
            .matrix-frame { padding: 20px 10px; overflow-x: auto; -webkit-overflow-scrolling: touch; border-radius: 20px; }
            .oti-table { min-width: 900px; }
            .search-area input { padding: 20px 20px 20px 70px; font-size: 16px; }
        }
    </style>
</head>
<body>

    <aside class="sidebar-master">
        <div class="header-brand animate__animated animate__fadeInDown">
            <h2>PRONIED</h2>
            <p>Oficina de Tecnologías de la Información</p>
        </div>

        <nav>
            <a href="https://proniedoti.sharepoint.com/:f:/s/OTI_PUBLICACION/IgAc20aeiphBSKHNxQC9pwsTAfcubRjK846zDq8NTwj3Gaw?e=hJUgWx" target="_blank" class="nav-link">
                <i class="fas fa-database"></i> <span>SharePoint OTI</span>
            </a>
            <a href="https://www.gob.pe/institucion/pcm/colecciones/4887-entidades-con-mayor-avance-en-gobierno-y-transformacion-digital" target="_blank" class="nav-link">
                <i class="fas fa-microchip"></i> <span>Reporte PCM</span>
            </a>
            <a href="https://proniedoti.sharepoint.com/:f:/s/OTI_PUBLICACION/IgADoGLBzVyjQKUgVA4z9FEBAeNuwVBtinrim1sKUs4qZgg?e=IjBr4N" target="_blank" class="nav-link">
                <i class="fas fa-file-signature"></i> <span>Marco Normativo</span>
            </a>
        </nav>

        <div class="metrics-card animate__animated animate__fadeInUp">
            <span class="label">Estado situacional</span>
            <div class="grid-stats">
                <div class="stat-item s-ok"><b>12</b><span>Cumplidos</span></div>
                <div class="stat-item s-pen"><b>5</b><span>Pendientes</span></div>
                <div class="stat-item s-upd"><b>2</b><span>Por actualizar</span></div>
                <div class="stat-item s-na"><b>1</b><span>No Aplica</span></div>
            </div>
        </div>

        <div class="progress-box animate__animated animate__fadeInUp">
            <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                <span style="font-size: 9px; font-weight: 800; opacity: 0.7;">KPI ESTRATÉGICO</span>
                <b id="js-perc">0%</b>
            </div>
            <div class="rail"><div class="fill" id="js-bar"></div></div>
            <p style="text-align:center; font-size:8px; font-weight:900; opacity:0.5; letter-spacing:1px;">PORCENTAJE DE CUMPLIMIENTO</p>
        </div>
    </aside>

    <main class="workspace">
        <h1 class="animate__animated animate__zoomIn">Matriz Digital de Compromisos</h1>
        
        <div class="search-area animate__animated animate__fadeIn">
            <i class="fas fa-search"></i>
            <input type="text" id="js-search" placeholder="Buscar por ID, Compromiso, Marco Legal, Estado u Observación...">
        </div>

        <div class="hub-buttons">
            <button class="btn-hub btn-main" onclick="window.print()">
                <i class="fas fa-file-pdf"></i> GENERAR REPORTE PDF
            </button>
            <a href="https://www.gob.pe/39079" target="_blank" class="btn-hub btn-sec">
                <i class="fas fa-paper-plane"></i> REPORTAR A PCM
            </a>
        </div>

        <div class="matrix-frame animate__animated animate__fadeInUp">
            <table class="oti-table">
                <thead>
                    <tr>
                        <th class="col-id">ID</th>
                        <th>HITO ESTRATÉGICO / MARCO NORMATIVO</th>
                        <th class="col-status">ESTADO</th>
                        <th class="col-obs">OBSERVACIONES TÉCNICAS</th>
                    </tr>
                </thead>
                <tbody id="js-target"></tbody>
            </table>
        </div>
    </main>

    <script>
        /**
         * CONFIGURACIÓN DE CONSTANTES Y DATOS MAESTROS
         * Se mantiene la integridad de la data original del PRONIED
         */
        const NORMAS_URL = "https://proniedoti.sharepoint.com/:f:/s/OTI_PUBLICACION/IgADoGLBzVyjQKUgVA4z9FEBAeNuwVBtinrim1sKUs4qZgg?e=IjBr4N";

        const DATA = [
            { id: "01", t: "Incorporar transformación digital en PEI", n: "D.S. Nº 029-2021-PCM", e: "CUMPLIDO", c: "s-ok", o: "Hito alineado con los objetivos estratégicos institucionales del PRONIED." },
            { id: "02", t: "Designar al Líder de Gobierno Digital", n: "D.S. Nº 033-2018-PCM", e: "POR ACTUALIZAR", c: "s-upd", o: "Se requiere actualizar la resolución de designación en plataforma FACILITA." },
            { id: "03", t: "Constituir el Comité de Gobierno Digital", n: "R.M. Nº 119-2018-PCM", e: "CUMPLIDO", c: "s-ok", o: "Comité instalado con actas de sesión vigentes y aprobadas." },
            { id: "04", t: "Aprobar el Plan de Gobierno Digital", n: "Res. SGD Nº 005-2018-PCM", e: "CUMPLIDO", c: "s-ok", o: "PGD aprobado y en fase de ejecución." },
            { id: "05", t: "Página web institucional en GOB.PE", n: "D.S. N º 033-2018-PCM", e: "CUMPLIDO", c: "s-ok", o: "Migración completada. Portal operativo bajo estándares de PCM." },
            { id: "06", t: "Modelo de Gestión Documental", n: "D.S. Nº 029-2021-PCM", e: "CUMPLIDO", c: "s-ok", o: "Interoperabilidad de firmas digitales implementada exitosamente." },
            { id: "07", t: "Equipo de Respuesta CSIRT", n: "D.U. N°007-2020", e: "CUMPLIDO", c: "s-ok", o: "Protocolos de respuesta ante incidentes de ciberseguridad activos." },
            { id: "08", t: "Publicar Datos Abiertos", n: "D.L. N°1412", e: "CUMPLIDO", c: "s-ok", o: "Datasets actualizados mensualmente en el portal nacional." },
            { id: "09", t: "Información Georreferenciada", n: "D.S. N° 029-2021-PCM", e: "PENDIENTE", c: "s-pen", o: "Pendiente integración de locales escolares regionales." },
            { id: "10", t: "Estrategia Digital Institucional", n: "Estrategia Nacional", e: "PENDIENTE", c: "s-pen", o: "En fase de diagnóstico por el equipo técnico OTI." },
            { id: "11", t: "Oficial de Seguridad Digital", n: "R.M. N° 166-2017-PCM", e: "POR ACTUALIZAR", c: "s-upd", o: "Ratificación de designación en proceso administrativo." },
            { id: "12", t: "Implementar el SGSI", n: "ISO 27001 - PCM", e: "CUMPLIDO", c: "s-ok", o: "Controles aplicados según normativa ISO de seguridad." },
            { id: "13", t: "Responsable de Software Público", n: "D.S. Nº051-2018-PCM", e: "CUMPLIDO", c: "s-ok", o: "Inventario registrado ante la Secretaría de Gobierno Digital." },
            { id: "14", t: "Transición al Protocolo IPV6", n: "Agenda Digital", e: "PENDIENTE", c: "s-pen", o: "Evaluación técnica de compatibilidad de red en curso." },
            { id: "15", t: "Mesa de Partes Digital", n: "D.S. N°205-2020-PCM", e: "CUMPLIDO", c: "s-ok", o: "Canal digital operativo con flujos automáticos." },
            { id: "16", t: "Publicar TUPA en GOB.PE", n: "D.L. No 1452", e: "NO APLICA", c: "s-na", o: "Hito no aplicable en el actual ciclo institucional." },
            { id: "17", t: "Encuesta de Activos Digitales", n: "R.M. N°310-2013-PCM", e: "CUMPLIDO", c: "s-ok", o: "Reporte nacional enviado satisfactoriamente a SEGDI." },
            { id: "18", t: "Interoperabilidad PIDE", n: "D.S. Nº 083-2011-PCM", e: "CUMPLIDO", c: "s-ok", o: "Consumo de servicios web vía PIDE configurado." },
            { id: "19", t: "Transparencia Estándar", n: "D.S. N° 063-2010-PCM", e: "PENDIENTE", c: "s-pen", o: "Actualización de enlaces de transparencia en curso." },
            { id: "20", t: "Oficial de Gobierno de Datos", n: "Res. 244-2022", e: "PENDIENTE", c: "s-pen", o: "Pendiente asignación por la alta dirección." }
        ];

        /**
         * FUNCIÓN DE RENDERIZADO MEJORADA
         * Realiza el filtrado dinámico en múltiples columnas de forma simultánea.
         */
        function render(filterValue = "") {
            const container = document.getElementById('js-target');
            const searchKeyword = filterValue.toLowerCase().trim();

            // Lógica de filtrado avanzada: busca en todas las propiedades del objeto
            const filteredData = DATA.filter(item => {
                const matchID = item.id.toLowerCase().includes(searchKeyword);
                const matchTitle = item.t.toLowerCase().includes(searchKeyword);
                const matchNorma = item.n.toLowerCase().includes(searchKeyword);
                const matchStatus = item.e.toLowerCase().includes(searchKeyword);
                const matchObs = item.o.toLowerCase().includes(searchKeyword);

                // Retorna verdadero si alguna columna coincide
                return (matchID || matchTitle || matchNorma || matchStatus || matchObs);
            });

            // Gestión de estado vacío
            if (filteredData.length === 0) {
                container.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align:center; padding: 60px; background: #fff;">
                            <i class="fas fa-search" style="font-size: 40px; color: #cbd5e1; margin-bottom: 20px; display: block;"></i>
                            <span style="font-weight: 800; color: #64748b; font-size: 16px; text-transform: uppercase;">
                                No se encontraron resultados para: "${filterValue}"
                            </span>
                        </td>
                    </tr>`;
                return;
            }

            // Construcción del HTML dinámico
            let htmlContent = "";
            for (let i = 0; i < filteredData.length; i++) {
                const record = filteredData[i];
                htmlContent += `
                    <tr class="animate__animated animate__fadeIn">
                        <td class="cell-id">${record.id}</td>
                        <td>
                            <div class="cell-content-center">
                                <span class="cell-title">${record.t}</span>
                                <a href="${NORMAS_URL}" target="_blank" class="cell-norma">
                                    <i class="fas fa-link"></i> ${record.n}
                                </a>
                            </div>
                        </td>
                        <td>
                            <span class="pill-status ${record.c}">
                                ${record.e}
                            </span>
                        </td>
                        <td>
                            <p class="obs-content">
                                ${record.o}
                            </p>
                        </td>
                    </tr>`;
            }
            
            container.innerHTML = htmlContent;
        }

        /**
         * INICIALIZADOR DE EVENTOS Y LÓGICA DE CARGA
         */
        document.addEventListener('DOMContentLoaded', () => {
            // Ejecución inicial de la tabla
            render();

            // Escucha activa del buscador con soporte para múltiples columnas
            const searchInput = document.getElementById('js-search');
            if (searchInput) {
                searchInput.addEventListener('input', (event) => {
                    const value = event.target.value;
                    render(value);
                });
            }

            // Cálculo y animación de la barra de progreso institucional
            const totalItems = DATA.length;
            const completedItems = DATA.filter(item => item.e === "CUMPLIDO").length;
            const percentage = Math.round((completedItems / totalItems) * 100);
            
            // Animación diferida para impacto visual
            setTimeout(() => {
                const progressBar = document.getElementById('js-bar');
                const progressText = document.getElementById('js-perc');
                
                if (progressBar) {
                    progressBar.style.width = percentage + "%";
                }
                if (progressText) {
                    progressText.innerText = percentage + "%";
                }
            }, 850);
        });

        // Soporte adicional para impresión
        window.onbeforeprint = () => {
            console.log("Preparando matriz para impresión oficial...");
        };
    </script>
</body>
</html>